## Overview

This is a simple example of Next.js Partial Page Rendering (PPR) in action.

1. The layout has `experimental_ppr` set.
2. The page has:
3. a static component that renders the Next.js build id
4. a dynamic component that reads a UUID from an HTTP-Only cookie, with a
   slight, artificial delay.
5. middleware that sets the UUID cookie if not present.
6. UUIDs are generated by calling the UUID API at <httpbin.org>.

When viewing the page, the static content persists, but the dynamic one will be
different for each session.

## What is PPR?

Donut caching: the page shell is served statically (the donut), while certain
dynamic parts of the page are streamed in later (to fill the holes).

### Examples

- [Next.js Partial Prerendering](https://www.partialprerendering.com/) ([GitHub](https://github.com/vercel-labs/next-partial-prerendering))

### How to enable it?

1. Set the experimental `{ ppr: 'incremental' }` flag in `next.config`.
2. Add the `experimental_ppr: true` route config option to a layout or page route.
3. Wrap dynamic components in `<Suspense />` boundaries.

### Caveats

1. For a component to be considered _dynamic_, it seems to need to use a Next.js dynamic function, or access the search params.
2. Adding `experimental_ppr: true` to a _layout_ does not seem to automatically apply it to the _page_ within the layout.

## TODO

- [ ] Add a server action to change the cookie value
- [ ] Confirm rules for _dynamic_ components
- [ ] Confirm behaviour of `experimental_ppr` flag on _layout_ vs. _page_
